@//workspace/_bmad-output/implementation-artifacts/sprint-status.yaml
@//workspace/_bmad/bmm/config.yaml
@//workspace/progress.txt

# BMAD Development Workflow - Story-Driven Implementation

You are executing the BMAD (Business-Managed Agile Development) methodology.
Follow these instructions EXACTLY:
## EPIC SCOPE
Focus ONLY on these epics: Epic2

## 1. Story Discovery & Selection
- Load config from @_bmad/bmm/config.yaml (user_name, project_name, skill_level)
- Review @sprint-status.yaml to identify story states and epic progress
- Check @progress.txt to see what tasks have been completed in current session
- **RESPECT EPIC SCOPE**: Only work on stories within the specified epic(s)
- Select the HIGHEST PRIORITY story with status 'ready-for-dev' within allowed epic(s)
- Load the story file from @_bmad-output/implementation-artifacts/[story-id].md
- If no 'ready-for-dev' stories exist in scope, check for 'in-progress' stories to continue
## 2. Story Context Loading
- Read the complete story file: [story-id].md from //workspace/_bmad-output/implementation-artifacts/
- Parse the Story section (user story format)
- Review Acceptance Criteria (Given-When-Then format)
- Load Tasks/Subtasks section - this is your AUTHORITATIVE implementation guide
- Review Dev Notes for architecture requirements and technical constraints
- Check Dependencies section to ensure prerequisite stories are complete
- Load project-context.md if it exists for coding standards
## 3. Task-Driven Implementation (Red-Green-Refactor)
- Work through Tasks/Subtasks in EXACT order listed in the story file
- For EACH task/subtask:
  * RED: Write FAILING tests first (unit, integration, e2e as needed)
  * GREEN: Implement MINIMAL code to make tests pass
  * REFACTOR: Improve code structure while keeping tests green
  * VALIDATE: Run full test suite - NO regressions allowed
  * MARK COMPLETE: Update story file - change [ ] to [x] for completed task
  * UPDATE FILE LIST: Add all modified files to the File List section
  * DOCUMENT: Add completion notes to Dev Agent Record section
## 4. Quality Gates (NEVER skip)
- All existing tests MUST pass before proceeding to next task
- New tests MUST exist and pass for each task
- Follow acceptance criteria EXACTLY - no extra features
- Verify all subtasks under a parent task are complete before marking parent complete
- Update story file's File List with all changed files
- Document key decisions in Dev Agent Record
## 5. Progress Tracking
- Update the story file in implementation-artifacts/ after EACH completed task
- Append to progress.txt after each completed task:
  * Story ID and task number completed
  * Files created/modified
  * Tests added/updated
  * Any blockers or technical decisions
- Make atomic git commits per task with format: '[story-id] Complete task N: description'
## 6. Story Completion
- When ALL tasks/subtasks in story file are marked [x] complete
- AND all tests pass (run full test suite)
- Before committing, run ALL feedback loops:
  * TypeScript: npm run typecheck (must pass with no errors)
  * Tests: npm run test (must pass)
  * Lint: npm run lint (must pass)
- AND all acceptance criteria are satisfied
- THEN:
  * Update story status in sprint-status.yaml: 'ready-for-dev' â†’ 'review'
  * Update story file header: Status: review
  * Make final git commit: '[story-id] Story complete - moved to review'
  * Output: <promise>STORY-COMPLETE: [story-id]</promise>
  * **EXIT IMMEDIATELY** - Do NOT start the next story
## 7. Single Story Per Session Rule
- **CRITICAL**: Complete ONLY ONE story per session
- After completing a story and outputting <promise>STORY-COMPLETE</promise>, EXIT
- The script will launch a new Claude Code instance for the next story
- This ensures clean state and proper story isolation
## CRITICAL RULES:
- NEVER implement anything not explicitly listed in Tasks/Subtasks
- NEVER mark task complete without passing tests
- NEVER skip the red-green-refactor cycle
- ONLY work on ONE task at a time (sequential execution)
- ALWAYS update the story file after completing each task
- ALWAYS reference the implementation-artifacts/[story-id].md file as source of truth
- Execute continuously until COMPLETE or HALT condition
## FILE LOCATIONS:
- Story files: //workspace/_bmad-output/implementation-artifacts/[epic]-[story]-[name].md
- Sprint status: //workspace/_bmad-output/implementation-artifacts/sprint-status.yaml
- Progress log: //workspace/progress.txt
- Config: //workspace/_bmad/bmm/config.yaml
